{% extends 'content/base.html' %}
{% load static %}

{% block content %}
<!-- Jquery -->
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>

    <h1>Admin Page</h1>

    <form method="post">
      <label for="user_email">User ID:</label>
      <select id="user_email" name="user_email">
        {% for user in users %}
          <option value="user_email">{{ user.email }}</option>
        {% endfor %}
      </select>

      <label for="user_permission">Permission:</label>
      <select id="user_permission" name="user_permission">
        <option value="3">Admin</option>
        <option value="2">Staff</option>
        <option value="1">User</option>
      </select>

      <button id="permission_edit">Submit</button>

    </form>

    <script>

        $('#permission_edit').click(function () {
            alert("수정하기 눌렀다.");

            var user = document.getElementById('user_email');
            user_email = user.options[user.selectedIndex].text;
            var permission = document.getElementById('user_permission');
            user_permission = permission.options[permission.selectedIndex].value;

        $.ajax({
            url: "/content/adminpagepermiss" ,
            data: {
                user_email : user_email,
                user_permission : user_permission,
            },
            method: "POST",
            success: function (data) {
                console.log("성공");
                alert("권한을 수정하였습니다.");
                location.replace('/user/adminpage');
            },
            error: function (request, status, error) {
                alert("에러");
            },
            complete: function () {
                alert("완료");
            }
        });
    });

  </script>

{% endblock %}
